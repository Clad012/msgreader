<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>@kenjiuno/msgreader</title>
	<meta name="description" content="Documentation for @kenjiuno/msgreader">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">@kenjiuno/msgreader</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>@kenjiuno/msgreader</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#msgreader" id="msgreader" style="color: inherit; text-decoration: none;">
					<h1>msgreader</h1>
				</a>
				<p><a href="https://www.npmjs.com/package/@kenjiuno/msgreader"><img src="https://img.shields.io/npm/v/@kenjiuno/msgreader" alt="npm"></a>
				<a href="https://dev.azure.com/HiraokaHyperTools/msgreader/_build/latest?definitionId=7&amp;branchName=master"><img src="https://dev.azure.com/HiraokaHyperTools/msgreader/_apis/build/status/HiraokaHyperTools.msgreader?branchName=master" alt="Build Status"></a></p>
				<p>Outlook Item File (.msg) reader in JavaScript npm Module</p>
				<p>Original projects:</p>
				<ul>
					<li><a href="https://github.com/FreiraumIO/msgreader">https://github.com/FreiraumIO/msgreader</a></li>
					<li><a href="https://github.com/ykarpovich/msg.reader">https://github.com/ykarpovich/msg.reader</a></li>
				</ul>
				<p>This repo contains the code of the modified project.
				And also it is published as a <a href="https://www.npmjs.com/package/@kenjiuno/msgreader">npm package</a>.</p>
				<p>Links: <a href="https://hiraokahypertools.github.io/msgreader/"><em>typedoc documentation</em></a></p>
				<a href="#how-to-use" id="how-to-use" style="color: inherit; text-decoration: none;">
					<h2>How to use</h2>
				</a>
				<pre><code class="language-javascript"><span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">fs</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;fs&#039;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">MsgReader</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;@kenjiuno/msgreader&#039;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">msgFileBuffer</span><span style="color: #000000"> = </span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">readFileSync</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;./data/test.msg&#039;</span><span style="color: #000000">)</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">testMsg</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">MsgReader</span><span style="color: #000000">(</span><span style="color: #001080">msgFileBuffer</span><span style="color: #000000">)</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">testMsgInfo</span><span style="color: #000000"> = </span><span style="color: #001080">testMsg</span><span style="color: #000000">.</span><span style="color: #795E26">getFileData</span><span style="color: #000000">()</span>
<span style="color: #008000">/**</span>
<span style="color: #008000">  testMsgInfo contains:</span>
<span style="color: #008000">  {</span>
<span style="color: #008000">    attachments:[</span>
<span style="color: #008000">      {</span>
<span style="color: #008000">        dataId:62,</span>
<span style="color: #008000">        contentLength:122784,</span>
<span style="color: #008000">        fileName:&#039;5AAoPFgV-nJ965R7o-98C38840-4454-4750-9AEF-F53DB3E37548.jpg&#039;,</span>
<span style="color: #008000">        fileNameShort:&#039;5AAOPF~1.JPG&#039;</span>
<span style="color: #008000">      }</span>
<span style="color: #008000">    ],</span>
<span style="color: #008000">    recipients:[</span>
<span style="color: #008000">      {</span>
<span style="color: #008000">        name:&#039;christoph@freiraum.xyz&#039;</span>
<span style="color: #008000">      }</span>
<span style="color: #008000">    ],</span>
<span style="color: #008000">    senderName:&#039;christoph@freiraum.xyz&#039;,</span>
<span style="color: #008000">    body:&#039; \r\n\r\n&#039;,</span>
<span style="color: #008000">    headers:&#039;Return-Path: &lt;christoph@freiraum.xyz&gt;\r\nReceived: from DESKTOPGBT9Q6P (HSI-KBW-109-193-162-142.hsi7.kabel-badenwuerttemberg.de. [109.193.162.142])\r\n        by smtp.gmail.com with ESMTPSA id q81sm10535131wmg.8.2018.03.23.09.06.30\r\n        for &lt;christoph@freiraum.xyz&gt;\r\n        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);\r\n        Fri, 23 Mar 2018 09:06:30 -0700 (PDT)\r\nFrom: &lt;christoph@freiraum.xyz&gt;\r\nTo: &lt;christoph@freiraum.xyz&gt;\r\nSubject: asdf\r\nDate: Fri, 23 Mar 2018 17:06:29 +0100\r\nMessage-ID: &lt;000001d3c2c0$e7ca4aa0$b75edfe0$@freiraum.xyz&gt;\r\nMIME-Version: 1.0\r\nContent-Type: multipart/mixed;\r\n\tboundary=&quot;----=_NextPart_000_0001_01D3C2C9.498F75F0&quot;\r\nX-Mailer: Microsoft Outlook 16.0\r\nThread-Index: AdPCwN90aOYoV24DTGKfv8JaCuci0g==\r\nContent-Language: de\r\n\r\n&#039;,</span>
<span style="color: #008000">    subject:&#039;asdf&#039;</span>
<span style="color: #008000">  }</span>
<span style="color: #008000">**/</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">testMsgAttachment0</span><span style="color: #000000"> = </span><span style="color: #001080">testMsg</span><span style="color: #000000">.</span><span style="color: #795E26">getAttachment</span><span style="color: #000000">(</span><span style="color: #001080">testMsgInfo</span><span style="color: #000000">.</span><span style="color: #001080">attachments</span><span style="color: #000000">[</span><span style="color: #098658">0</span><span style="color: #000000">])</span>
<span style="color: #008000">/**</span>
<span style="color: #008000">  testMsgAttachment0 === testMsg.getAttachment[0] and both contain:</span>
<span style="color: #008000">  { </span>
<span style="color: #008000">    fileName: &#039;5AAoPFgV-nJ965R7o-98C38840-4454-4750-9AEF-F53DB3E37548.jpg&#039;,</span>
<span style="color: #008000">    content: &lt;Uint8Array&gt; //content removed</span>
<span style="color: #008000">  }</span>
<span style="color: #008000">**/</span>
</code></pre>
				<a href="#list-attachment-files" id="list-attachment-files" style="color: inherit; text-decoration: none;">
					<h3>List attachment files</h3>
				</a>
				<pre><code class="language-javascript"><span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">msgFileBuffer</span><span style="color: #000000"> = </span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">readFileSync</span><span style="color: #000000">(</span><span style="color: #001080">msgFilePath</span><span style="color: #000000">)</span>
<span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">testMsg</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">MsgReader</span><span style="color: #000000">(</span><span style="color: #001080">msgFileBuffer</span><span style="color: #000000">)</span>
<span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">testMsgInfo</span><span style="color: #000000"> = </span><span style="color: #001080">testMsg</span><span style="color: #000000">.</span><span style="color: #795E26">getFileData</span><span style="color: #000000">()</span>

<span style="color: #000000">  </span><span style="color: #AF00DB">for</span><span style="color: #000000"> (</span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">att</span><span style="color: #000000"> </span><span style="color: #0000FF">of</span><span style="color: #000000"> </span><span style="color: #001080">testMsgInfo</span><span style="color: #000000">.</span><span style="color: #001080">attachments</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">att</span><span style="color: #000000">.</span><span style="color: #001080">fileName</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #008000">// testMsg.getAttachment(att).content</span>
<span style="color: #000000">  }</span>
</code></pre>
				<a href="#build-msgreader-locally" id="build-msgreader-locally" style="color: inherit; text-decoration: none;">
					<h2>Build msgreader locally</h2>
				</a>
				<pre><code class="language-bat"><span style="color: #000000">yarn</span>
</code></pre>
				<a href="#optional-command-line-tool" id="optional-command-line-tool" style="color: inherit; text-decoration: none;">
					<h2>Optional command line tool</h2>
				</a>
				<p>This can be used for testing this tool.</p>
				<pre><code class="language-bat"><span style="color: #000000">C:\Proj\msgreader&gt;node cli -h</span>
<span style="color: #000000">Usage: cli [options] [command]</span>

<span style="color: #000000">Options:</span>
<span style="color: #000000">  -h, --help                             output usage information</span>

<span style="color: #000000">Commands:</span>
<span style="color: #000000">  parse [options] &lt;msgFilePath&gt;          Parse </span><span style="color: #0000FF">msg</span><span style="color: #000000"> file and </span><span style="color: #0000FF">print</span><span style="color: #000000"> parsed structure</span>
<span style="color: #000000">  rtf &lt;msgFilePath&gt; [saveToRtfFilePath]  Parse </span><span style="color: #0000FF">msg</span><span style="color: #000000"> file and </span><span style="color: #0000FF">print</span><span style="color: #000000"> decompressed rtf</span>
<span style="color: #000000">  list-att &lt;msgFilePath&gt;                 Parse </span><span style="color: #0000FF">msg</span><span style="color: #000000"> file and list attachment file names</span>
<span style="color: #000000">  save-att &lt;msgFilePath&gt; &lt;saveToDir&gt;     Parse </span><span style="color: #0000FF">msg</span><span style="color: #000000"> file and write all attachment files</span>
</code></pre>
				<p>Obtain decompressed RTF file from <code>test/test1.msg</code>:</p>
				<pre><code class="language-bat"><span style="color: #000000">C:\Proj\msgreader&gt;node cli rtf test\test1.msg test1.rtf</span>

<span style="color: #000000">C:\Proj\msgreader&gt;type test1.rtf</span>
<span style="color: #000000">{\rtf1\ansi\ansicpg1252\fromtext \fbidis \deff0{\fonttbl</span>
<span style="color: #000000">{\f0\fswiss Arial;}</span>
<span style="color: #000000">{\f1\fmodern Courier New;}</span>
<span style="color: #000000">{\f2\fnil\fcharset2 Symbol;}</span>
<span style="color: #000000">{\f3\fmodern\fcharset0 Courier New;}}</span>
<span style="color: #000000">{\colortbl\red0\green0\blue0;\red0\green0\blue255;}</span>
<span style="color: #000000">\uc1\pard\plain\deftab360 \f0\fs20 body\par</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>List attachment files in <code>test/test2.msg</code>:</p>
				<pre><code class="language-bat"><span style="color: #000000">C:\Proj\msgreader&gt;node cli list-att test\test2.msg</span>
<span style="color: #000000">A.txt</span>
</code></pre>
				<p>Extract attacument files into folder <code>test2</code>:</p>
				<pre><code class="language-bat"><span style="color: #000000">C:\Proj\msgreader&gt;node cli save-att test\test2.msg test2</span>
</code></pre>
				<pre><code class="language-bat"><span style="color: #000000">C:\Proj\msgreader&gt;dir test2</span>
<span style="color: #000000"> Volume in drive C has no label.</span>
<span style="color: #000000"> Volume Serial Number is CA6D-4F59</span>

<span style="color: #000000"> Directory of C:\Proj\msgreader\test2</span>

<span style="color: #000000">2020/03/19  19:40    &lt;DIR&gt;          .</span>
<span style="color: #000000">2020/03/19  19:40    &lt;DIR&gt;          ..</span>
<span style="color: #000000">2020/03/19  19:40                </span><span style="color: #098658">11</span><span style="color: #000000"> A.txt</span>
<span style="color: #000000">               </span><span style="color: #098658">1</span><span style="color: #000000"> File(s)             </span><span style="color: #098658">11</span><span style="color: #000000"> bytes</span>
<span style="color: #000000">               </span><span style="color: #098658">2</span><span style="color: #000000"> Dir(s)   9,542,762,496 bytes free</span>
</code></pre>
				<pre><code class="language-bat"><span style="color: #000000">C:\Proj\msgreader&gt;type test2\A.txt</span>
<span style="color: #000000">attach test</span>
</code></pre>
				<p>Checking date times from <code>sent.msg</code>:</p>
				<pre><code class="language-bat"><span style="color: #000000">node cli parse test\sent.msg</span>

<span style="color: #000000">{</span>
<span style="color: #000000">  dataType: &#039;msg&#039;,</span>
<span style="color: #000000">  attachments: [],</span>
<span style="color: #000000">  recipients: [</span>
<span style="color: #000000">    {</span>
<span style="color: #000000">      dataType: &#039;recipient&#039;,</span>
<span style="color: #000000">      name: </span><span style="color: #A31515">&quot;&#039;xmailuser@xmailserver.test&#039;&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">      email: &#039;xmailuser@xmailserver.test&#039;,</span>
<span style="color: #000000">      recipType: &#039;to&#039;</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">  ],</span>
<span style="color: #000000">  senderEmail: &#039;xmailuser@xmailserver.test&#039;,</span>
<span style="color: #000000">  subject: &#039;Sent time&#039;,</span>
<span style="color: #000000">  body: &#039;Test mail\r\n\r\n&#039;,</span>
<span style="color: #000000">  senderName: &#039;xmailuser&#039;,</span>
<span style="color: #000000">  compressedRtf: Uint8Array(1409) [</span>
<span style="color: #000000">    ...</span>
<span style="color: #000000">  ],</span>
<span style="color: #000000">  creationTime: &#039;Mon, </span><span style="color: #098658">15</span><span style="color: #000000"> Feb </span><span style="color: #098658">2021</span><span style="color: #000000"> 08:19:21 GMT&#039;,</span>
<span style="color: #000000">  lastModificationTime: &#039;Mon, </span><span style="color: #098658">15</span><span style="color: #000000"> Feb </span><span style="color: #098658">2021</span><span style="color: #000000"> 08:19:21 GMT&#039;,</span>
<span style="color: #000000">  clientSubmitTime: &#039;Mon, </span><span style="color: #098658">15</span><span style="color: #000000"> Feb </span><span style="color: #098658">2021</span><span style="color: #000000"> 08:19:04 GMT&#039;,</span>
<span style="color: #000000">  messageDeliveryTime: &#039;Mon, </span><span style="color: #098658">15</span><span style="color: #000000"> Feb </span><span style="color: #098658">2021</span><span style="color: #000000"> 08:19:00 GMT&#039;</span>
<span style="color: #000000">}</span>
</code></pre>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Modules</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/Burner.html">Burner</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/DataStream.html">Data<wbr>Stream</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/MsgReader.html">Msg<wbr>Reader</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/Reader.html">Reader</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>